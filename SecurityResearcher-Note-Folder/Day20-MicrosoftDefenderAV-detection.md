# Day 20 - Microsoft Defender AV detection
Hi Defender,

I often hear this question from everyone: whether Microsoft Defender for Endpoint (MDE) can detect open-Source malicious tools or not. Commonly, these tools include Mimikatz, Impacket, Cobalt Strike, Metasploit, BloodHound, Rubeus, PowerSploit, and Empire.

Let me assure you that MDE can definitely capture the execution of these tools, as the EDR sensor is constantly monitoring for suspicious behavior. However, I’d also like to highlight that Microsoft Defender Antivirus can prevent these tools at the outset, even before they reach the stage where EDR detection comes into play.

At this time, I’d like to show you the detection list for each malicious tool detected by Microsoft Defender AV.

> [!Important]
> The purpose of this blog is not to showcase or demonstrate how to test these tools. Instead, it aims to inform everyone that Microsoft Defender Antivirus has robust detection capabilities and can prevent the execution of these tools even before EDR features come into play.

## Malware names
Before we dive into the detection details, let's look at how Microsoft Defender Antivirus categorizes and detects each malware tools - [MS docs : Malware names](https://learn.microsoft.com/en-us/defender-xdr/malware-naming)

```
Type           : Describes what the malware does on your computer.
Platforms      : Platforms guide the malware to its compatible OS (such as Windows, macOS, Linux, and Android). 
Family         : Grouping of malware based on common characteristics, including attribution to the same authors. 
Variant letter : Used sequentially for every distinct version of a malware famil
Suffixes       : Provides extra detail about the malware, including how it's used as part of a multicomponent threat.
```

![image](https://github.com/user-attachments/assets/18a74c64-fd7f-4a30-97ef-120aeb7bd1f1)

## Microsofot Defender AV detection
|Tools          | AV detection /  Malware name     |
|:--------------|:---------------------------------|
|Mimikatz       |[HackTool:Win32/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/Mimikatz) <br> [PUA:Win32/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=PUA:Win32/Mimikatz) <br> [Trojan:BAT/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:BAT/Mimikatz) <br> [HackTool:JS/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:JS/Mimikatz) <br> [Trojan:MSIL/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:MSIL/Mimikatz) <br> [HackTool:SH/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:SH/Mimikatz) <br> [Trojan:Win32/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/Mimikatz) <br> [Trojan:Win64/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win64/Mimikatz) <br> [HackTool:MSIL/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:MSIL/Mimikatz) <br> [HackTool:Win64/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win64/Mimikatz) <br> [Trojan:PowerShell/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:PowerShell/Mimikatz) <br> [HackTool:PowerShell/Mimikatz](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:PowerShell/Mimikatz) |
|Impacket       |[HackTool:Win32/Impacket](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/Impacket&threatId=-2147239074) <br> [HackTool:Python/Impacket](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Python/Impacket&threatId=-2147120172) <br> [PUA:Python/Impacket](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=PUA:Python/Impacket) |
|Cobalt Strike  |[Trojan:XML/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:XML/CobaltStrike) <br> [VirTool:MacOS/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=VirTool:MacOS/CobaltStrike) <br> [HackTool:Win64/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win64/CobaltStrike) <br> [HackTool:Win32/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/CobaltStrike) <br>[Backdoor:Win64/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Backdoor:Win64/CobaltStrike) <br> [Backdoor:Win32/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Backdoor:Win32/CobaltStrike) <br> [Behavior:Win32/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Behavior:Win32/CobaltStrike) <br> [Trojan:Win32/Cobaltstrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win32/Cobaltstrike) <br> [Trojan:Win64/Cobaltstrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:Win64/Cobaltstrike) <br> [HackTool:Linux/Cobaltstrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Linux/Cobaltstrike) <br> [TrojanDownloader:Win32/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:Win32/CobaltStrike) <br> [TrojanDownloader:PowerShell/CobaltStrike](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:PowerShell/CobaltStrike) |
|Metasploit     | [Exploit:Ruby/Metasploit](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Exploit:Ruby/Metasploit) <br> [PUA:AndroidOS/Metasploit](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=PUA:AndroidOS/Metasploit) <br> [HackTool:Win32/Metasploit](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/Metasploit) <br> [TrojanDownloader:O97M/Metasploit](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:O97M/Metasploit) |
|BloodHound     | [HackTool:MSIL/BloodHound!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:MSIL/BloodHound!MSR) <br> [HackTool:Win64/BloodHound!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win64/BloodHound!MSR) <br> [HackTool:Win32/BloodHound!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/BloodHound!MSR) <br> [HackTool:Python/BloodHound!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Python/BloodHound!MSR) <br> [HackTool:PowerShell/BloodHound!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:PowerShell/BloodHound!MSR) |
|Rubeus         | [HackTool:Win64/Rubeus](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win64/Rubeus&threatId=-2147123253) |
|PowerSploit    | [HackTool:Win32/PowerSploit!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:Win32/PowerSploit!MSR) <br> [Trojan:PowerShell/Powersploit!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Trojan:PowerShell/Powersploit!MSR) <br> [HackTool:PowerShell/PowerSploit!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=HackTool:PowerShell/PowerSploit!MSR) <br> [TrojanDropper:PowerShell/PowerSploit!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDropper:PowerShell/PowerSploit!MSR) <br> [TrojanDownloader:PowerShell/Powersploit!MSR](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=TrojanDownloader:PowerShell/Powersploit!MSR) |
|Empire         | [Virus:DOS/Empire](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Virus:DOS/Empire) <br> [VirTool:BAT/Empire](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=VirTool:BAT/Empire) <br> [Virus:DOS/Evil_Empire](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Virus:DOS/Evil_Empire) <br> [Behavior:Win32/NriPowerShellEmpire](https://www.microsoft.com/en-us/wdsi/threats/malware-encyclopedia-description?Name=Behavior:Win32/NriPowerShellEmpire) <br> |

#### Disclaimer
1. The views and opinions expressed herein are those of the author and do not necessarily reflect the views of company.
2. The detection list is updated regularly, and to check the latest detections, please visit the Microsoft Threat Intelligence page.
